{"ast":null,"code":"var _jsxFileName = \"/Users/merin/dashboard-apps/inst/frontend/containers/Crud/Crud.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, Fragment, useEffect } from 'react';\nimport { AiFillCloseSquare } from 'react-icons/ai';\nimport { IoIosEye } from 'react-icons/io';\nimport { toaster } from 'baseui/toast';\nimport { Tag } from 'baseui/tag';\nimport { Block } from 'baseui/block';\nimport { Button } from 'baseui/button';\nimport { StyledTable, StyledBodyCell } from 'baseui/table-grid';\nimport IconButton from '../../components/UiElements/IconButton/IconButton';\nimport { StyledTableHeadAlt } from '../../components/PageStyles/Apps.styled';\nimport AddEditModal from './AddEdit';\nimport { firebaseCRUDPageData } from '../../data/appsData';\nimport { getDocuments, addDocument, updateDocument, deleteDocument } from '../../firebase/service';\nimport Toaster from '../../components/UiElements/Toaster/Toaster';\nimport Popover from '../../components/UiElements/Popover/Popover';\nconst statusOptions = [{\n  label: 'Draft',\n  id: 'draft'\n}, {\n  label: 'Publish',\n  id: 'publish'\n}];\n\nconst FirebaseCRUD = () => {\n  let toastKey;\n  const {\n    title,\n    subtitle\n  } = firebaseCRUDPageData;\n  const {\n    0: articles,\n    1: setArticles\n  } = useState([]);\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(false);\n  const {\n    0: editState,\n    1: setEditState\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  const {\n    0: article,\n    1: setArticle\n  } = useState({\n    id: null,\n    title: '',\n    description: '',\n    slug: '',\n    status: []\n  });\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    try {\n      const data = await getDocuments('articles');\n\n      if (data && data.length) {\n        setArticles(data);\n      }\n    } catch (error) {\n      toastKey = toaster.negative(__jsx(React.Fragment, null, 'Data Fetching Failed!'), {\n        autoHideDuration: 1000\n      });\n    }\n  };\n\n  const handleAddArticle = () => {\n    setVisible(true);\n    setEditState(false);\n  };\n\n  const handleModdalClose = () => {\n    setVisible(false);\n    setArticle({\n      id: null,\n      title: '',\n      description: '',\n      slug: '',\n      status: []\n    });\n  };\n\n  const handleDeleteArticle = async id => {\n    if (id) {\n      const deleted = await deleteDocument('articles', id);\n\n      if (deleted) {\n        fetchData();\n      }\n    }\n  };\n\n  const handleUpdateArticle = async item => {\n    setVisible(true);\n    setEditState(true);\n    const index = statusOptions.findIndex(option => option.id === item.status);\n    let status = {\n      label: 'Draft',\n      id: 'draft'\n    };\n\n    if (index > -1) {\n      status = statusOptions[index];\n    }\n\n    setArticle(_objectSpread({}, article, {}, item, {\n      status\n    }));\n  };\n\n  const handleOnChange = name => e => {\n    let value;\n\n    if (name === 'status') {\n      value = e.value;\n    } else {\n      value = e.target.value;\n    }\n\n    setArticle(_objectSpread({}, article, {\n      [name]: value\n    }));\n  };\n\n  const checkError = () => {\n    let errorStatus = false;\n    const {\n      title,\n      description,\n      slug,\n      status\n    } = article;\n\n    if (!title || !description || !slug || !status) {\n      errorStatus = true;\n    } else {\n      errorStatus = false;\n    }\n\n    setError(errorStatus);\n    return errorStatus;\n  };\n\n  const handleOnSubmit = async () => {\n    const errorStatus = checkError();\n    const status = article.status && article.status.length ? article.status[0].id : 'draft';\n    const slug = article.id ? article.slug : `${article.slug}-${Date.now()}`;\n\n    const data = _objectSpread({}, article, {\n      slug,\n      status\n    });\n\n    let id = null;\n\n    if (article.id && !errorStatus) {\n      try {\n        id = await updateDocument('articles', data);\n        toastKey = toaster.info(__jsx(React.Fragment, null, 'Update Successful!'), {\n          autoHideDuration: 2000\n        });\n      } catch (error) {\n        toastKey = toaster.negative(__jsx(React.Fragment, null, 'Update Failed!'), {\n          autoHideDuration: 2000\n        });\n        console.log(error);\n      }\n\n      setVisible(false);\n    } else if (!article.id && !errorStatus) {\n      try {\n        id = await addDocument('articles', data);\n        toastKey = toaster.info(__jsx(React.Fragment, null, 'Successful!'), {\n          autoHideDuration: 2000\n        });\n      } catch (error) {\n        toastKey = toaster.negative(__jsx(React.Fragment, null, 'Failed!'), {\n          autoHideDuration: 2000\n        });\n        console.log(error);\n      }\n\n      setVisible(false);\n    }\n\n    if (id) {\n      fetchData();\n    }\n  };\n\n  const handleConfirm = data => {\n    console.log(data, 'what data');\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Toaster, {\n    toastKey: toastKey,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }), __jsx(Block, {\n    paddingTop: ['10px', '10px', 0],\n    overrides: {\n      Block: {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          marginBottom: '40px'\n        }\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, __jsx(Block, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, __jsx(Block, {\n    as: \"h3\",\n    overrides: {\n      Block: {\n        style: ({\n          $theme\n        }) => {\n          return _objectSpread({}, $theme.typography.font450, {\n            color: $theme.colors.primaryA,\n            marginBottom: '10px'\n          });\n        }\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, title), __jsx(Block, {\n    as: \"p\",\n    overrides: {\n      Block: {\n        style: ({\n          $theme\n        }) => {\n          return _objectSpread({}, $theme.typography.font200, {\n            color: $theme.colors.contentSecondary\n          });\n        }\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, subtitle)), __jsx(Block, {\n    overrides: {\n      Block: {\n        style: {\n          flexShrink: 0\n        }\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, __jsx(Button, {\n    onClick: handleAddArticle,\n    overrides: {\n      BaseButton: {\n        style: ({\n          $theme\n        }) => {\n          return _objectSpread({}, $theme.typography.font250);\n        }\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, \"Add Article\"))), __jsx(Block, {\n    overrides: {\n      Block: {\n        style: {\n          minHeight: '150px'\n        }\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  }, __jsx(StyledTable, {\n    $gridTemplateColumns: \"130px 200px auto max-content max-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244\n    },\n    __self: this\n  }, __jsx(StyledTableHeadAlt, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245\n    },\n    __self: this\n  }, \"Title\"), __jsx(StyledTableHeadAlt, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246\n    },\n    __self: this\n  }, \"Description\"), __jsx(StyledTableHeadAlt, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247\n    },\n    __self: this\n  }, \"Slug\"), __jsx(StyledTableHeadAlt, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248\n    },\n    __self: this\n  }, \"Status\"), __jsx(StyledTableHeadAlt, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249\n    },\n    __self: this\n  }, \"Action\"), articles && articles.length ? articles.map((item, index) => {\n    const striped = index % 2 === 0;\n    if (item && !item.status) return null;\n    const status = item.status;\n    let tag;\n\n    switch (status) {\n      case 'publish':\n        tag = __jsx(Tag, {\n          kind: \"positive\",\n          variant: \"solid\",\n          closeable: false,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 259\n          },\n          __self: this\n        }, status);\n        break;\n\n      case 'draft':\n        tag = __jsx(Tag, {\n          kind: \"neutral\",\n          variant: \"light\",\n          closeable: false,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266\n          },\n          __self: this\n        }, status);\n        break;\n    }\n\n    return __jsx(Fragment, {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, __jsx(StyledBodyCell, {\n      $striped: striped,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }, item.title), __jsx(StyledBodyCell, {\n      $striped: striped,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, item.description), __jsx(StyledBodyCell, {\n      $striped: striped,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, item.slug), __jsx(StyledBodyCell, {\n      $striped: striped,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }, tag), __jsx(StyledBodyCell, {\n      $striped: striped,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, __jsx(IconButton, {\n      onClick: () => handleUpdateArticle(item),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, __jsx(IoIosEye, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    })), __jsx(Popover, {\n      content: \"Are you sure?\",\n      onConfirm: handleConfirm,\n      data: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      onFocus: ref => {\n        ref.currentTarget.focus();\n        let x = window.scrollX,\n            y = window.scrollY;\n        window.scrollTo(x, y);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, __jsx(Button, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, __jsx(AiFillCloseSquare, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }))))));\n  }) : null)), __jsx(AddEditModal, {\n    error: error,\n    article: article,\n    visible: visible,\n    editState: editState,\n    statusOptions: statusOptions,\n    handleOnChange: handleOnChange,\n    handleOnSubmit: handleOnSubmit,\n    handleModdalClose: handleModdalClose,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317\n    },\n    __self: this\n  }));\n};\n\nexport default FirebaseCRUD;","map":{"version":3,"sources":["/Users/merin/dashboard-apps/inst/frontend/containers/Crud/Crud.tsx"],"names":["React","useState","Fragment","useEffect","AiFillCloseSquare","IoIosEye","toaster","Tag","Block","Button","StyledTable","StyledBodyCell","IconButton","StyledTableHeadAlt","AddEditModal","firebaseCRUDPageData","getDocuments","addDocument","updateDocument","deleteDocument","Toaster","Popover","statusOptions","label","id","FirebaseCRUD","toastKey","title","subtitle","articles","setArticles","visible","setVisible","editState","setEditState","error","setError","article","setArticle","description","slug","status","fetchData","data","length","negative","autoHideDuration","handleAddArticle","handleModdalClose","handleDeleteArticle","deleted","handleUpdateArticle","item","index","findIndex","option","handleOnChange","name","e","value","target","checkError","errorStatus","handleOnSubmit","Date","now","info","console","log","handleConfirm","style","display","alignItems","justifyContent","marginBottom","$theme","typography","font450","color","colors","primaryA","font200","contentSecondary","flexShrink","BaseButton","font250","minHeight","map","striped","tag","ref","currentTarget","focus","x","window","scrollX","y","scrollY","scrollTo"],"mappings":"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","sourcesContent":["import React, { useState, Fragment, useEffect } from 'react';\nimport { AiFillCloseSquare } from 'react-icons/ai';\nimport { IoIosEye } from 'react-icons/io';\nimport { toaster } from 'baseui/toast';\nimport { Tag } from 'baseui/tag';\nimport { Block } from 'baseui/block';\nimport { Button } from 'baseui/button';\nimport { StyledTable, StyledBodyCell } from 'baseui/table-grid';\nimport IconButton from '../../components/UiElements/IconButton/IconButton';\nimport { StyledTableHeadAlt } from '../../components/PageStyles/Apps.styled';\nimport AddEditModal from './AddEdit';\nimport { firebaseCRUDPageData } from '../../data/appsData';\nimport {\n  getDocuments,\n  addDocument,\n  updateDocument,\n  deleteDocument,\n} from '../../firebase/service';\nimport Toaster from '../../components/UiElements/Toaster/Toaster';\nimport Popover from '../../components/UiElements/Popover/Popover';\n\nconst statusOptions = [\n  { label: 'Draft', id: 'draft' },\n  { label: 'Publish', id: 'publish' },\n];\n\nconst FirebaseCRUD = () => {\n  let toastKey;\n  const { title, subtitle } = firebaseCRUDPageData;\n  const [articles, setArticles] = useState([]);\n  const [visible, setVisible] = useState(false);\n  const [editState, setEditState] = useState(false);\n  const [error, setError] = useState(false);\n  const [article, setArticle] = useState({\n    id: null,\n    title: '',\n    description: '',\n    slug: '',\n    status: [],\n  });\n  useEffect(() => {\n    fetchData();\n  }, []);\n  const fetchData = async () => {\n    try {\n      const data = await getDocuments('articles');\n      if (data && data.length) {\n        setArticles(data);\n      }\n    } catch (error) {\n      toastKey = toaster.negative(<>{'Data Fetching Failed!'}</>, {\n        autoHideDuration: 1000,\n      });\n    }\n  };\n  const handleAddArticle = () => {\n    setVisible(true);\n    setEditState(false);\n  };\n\n  const handleModdalClose = () => {\n    setVisible(false);\n    setArticle({\n      id: null,\n      title: '',\n      description: '',\n      slug: '',\n      status: [],\n    });\n  };\n\n  const handleDeleteArticle = async (id: string) => {\n    if (id) {\n      const deleted = await deleteDocument('articles', id);\n      if (deleted) {\n        fetchData();\n      }\n    }\n  };\n\n  const handleUpdateArticle = async (item: any) => {\n    setVisible(true);\n    setEditState(true);\n    const index = statusOptions.findIndex(option => option.id === item.status);\n    let status = { label: 'Draft', id: 'draft' };\n    if (index > -1) {\n      status = statusOptions[index];\n    }\n    setArticle({\n      ...article,\n      ...item,\n      status,\n    });\n  };\n\n  const handleOnChange = (name: string) => (e: any) => {\n    let value: any;\n    if (name === 'status') {\n      value = e.value;\n    } else {\n      value = e.target.value;\n    }\n\n    setArticle({\n      ...article,\n      [name]: value,\n    });\n  };\n\n  const checkError = () => {\n    let errorStatus = false;\n    const { title, description, slug, status } = article;\n    if (!title || !description || !slug || !status) {\n      errorStatus = true;\n    } else {\n      errorStatus = false;\n    }\n    setError(errorStatus);\n    return errorStatus;\n  };\n  const handleOnSubmit = async () => {\n    const errorStatus = checkError();\n    const status =\n      article.status && article.status.length ? article.status[0].id : 'draft';\n    const slug = article.id ? article.slug : `${article.slug}-${Date.now()}`;\n    const data = {\n      ...article,\n      slug,\n      status,\n    };\n    let id = null;\n    if (article.id && !errorStatus) {\n      try {\n        id = await updateDocument('articles', data);\n        toastKey = toaster.info(<>{'Update Successful!'}</>, {\n          autoHideDuration: 2000,\n        });\n      } catch (error) {\n        toastKey = toaster.negative(<>{'Update Failed!'}</>, {\n          autoHideDuration: 2000,\n        });\n        console.log(error);\n      }\n      setVisible(false);\n    } else if (!article.id && !errorStatus) {\n      try {\n        id = await addDocument('articles', data);\n        toastKey = toaster.info(<>{'Successful!'}</>, {\n          autoHideDuration: 2000,\n        });\n      } catch (error) {\n        toastKey = toaster.negative(<>{'Failed!'}</>, {\n          autoHideDuration: 2000,\n        });\n        console.log(error);\n      }\n      setVisible(false);\n    }\n    if (id) {\n      fetchData();\n    }\n  };\n\n  const handleConfirm = data => {\n    console.log(data, 'what data');\n  };\n\n  return (\n    <>\n      <Toaster toastKey={toastKey} />\n      <Block\n        paddingTop={['10px', '10px', 0]}\n        overrides={{\n          Block: {\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              marginBottom: '40px',\n            },\n          },\n        }}\n      >\n        <Block>\n          <Block\n            as=\"h3\"\n            overrides={{\n              Block: {\n                style: ({ $theme }) => {\n                  return {\n                    ...$theme.typography.font450,\n                    color: $theme.colors.primaryA,\n                    marginBottom: '10px',\n                  };\n                },\n              },\n            }}\n          >\n            {title}\n          </Block>\n          <Block\n            as=\"p\"\n            overrides={{\n              Block: {\n                style: ({ $theme }) => {\n                  return {\n                    ...$theme.typography.font200,\n                    color: $theme.colors.contentSecondary,\n                  };\n                },\n              },\n            }}\n          >\n            {subtitle}\n          </Block>\n        </Block>\n        <Block overrides={{ Block: { style: { flexShrink: 0 } } }}>\n          <Button\n            onClick={handleAddArticle}\n            overrides={{\n              BaseButton: {\n                style: ({ $theme }) => {\n                  return {\n                    ...$theme.typography.font250,\n                  };\n                },\n              },\n            }}\n          >\n            Add Article\n          </Button>\n        </Block>\n      </Block>\n\n      <Block\n        overrides={{\n          Block: {\n            style: {\n              minHeight: '150px',\n            },\n          },\n        }}\n      >\n        <StyledTable $gridTemplateColumns=\"130px 200px auto max-content max-content\">\n          <StyledTableHeadAlt>Title</StyledTableHeadAlt>\n          <StyledTableHeadAlt>Description</StyledTableHeadAlt>\n          <StyledTableHeadAlt>Slug</StyledTableHeadAlt>\n          <StyledTableHeadAlt>Status</StyledTableHeadAlt>\n          <StyledTableHeadAlt>Action</StyledTableHeadAlt>\n          {articles && articles.length\n            ? articles.map((item, index) => {\n                const striped = index % 2 === 0;\n                if (item && !item.status) return null;\n                const status = item.status;\n                let tag;\n                switch (status) {\n                  case 'publish':\n                    tag = (\n                      <Tag kind=\"positive\" variant=\"solid\" closeable={false}>\n                        {status}\n                      </Tag>\n                    );\n                    break;\n                  case 'draft':\n                    tag = (\n                      <Tag kind=\"neutral\" variant=\"light\" closeable={false}>\n                        {status}\n                      </Tag>\n                    );\n                    break;\n                }\n                return (\n                  <Fragment key={index}>\n                    <StyledBodyCell $striped={striped}>\n                      {item.title}\n                    </StyledBodyCell>\n                    <StyledBodyCell $striped={striped}>\n                      {item.description}\n                    </StyledBodyCell>\n                    <StyledBodyCell $striped={striped}>\n                      {item.slug}\n                    </StyledBodyCell>\n                    <StyledBodyCell $striped={striped}>{tag}</StyledBodyCell>\n                    <StyledBodyCell $striped={striped}>\n                      <IconButton onClick={() => handleUpdateArticle(item)}>\n                        <IoIosEye />\n                      </IconButton>\n                      <Popover\n                        content=\"Are you sure?\"\n                        onConfirm={handleConfirm}\n                        data={item.id}\n                      >\n                        <div\n                          onFocus={ref => {\n                            ref.currentTarget.focus();\n                            let x = window.scrollX,\n                              y = window.scrollY;\n                            window.scrollTo(x, y);\n                          }}\n                        >\n                          <Button>\n                            <AiFillCloseSquare />\n                          </Button>\n                        </div>\n                        {/* <IconButton>\n                          <AiFillCloseSquare />\n                        </IconButton> */}\n                      </Popover>\n                    </StyledBodyCell>\n                  </Fragment>\n                );\n              })\n            : null}\n        </StyledTable>\n      </Block>\n\n      <AddEditModal\n        error={error}\n        article={article}\n        visible={visible}\n        editState={editState}\n        statusOptions={statusOptions}\n        handleOnChange={handleOnChange}\n        handleOnSubmit={handleOnSubmit}\n        handleModdalClose={handleModdalClose}\n      />\n    </>\n  );\n};\n\nexport default FirebaseCRUD;\n"]},"metadata":{},"sourceType":"module"}